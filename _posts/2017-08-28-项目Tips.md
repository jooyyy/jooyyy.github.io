---
layout:     post
title:      项目Tips
subtitle:   
date:       2017-08-28
author:     Joy
header-img: img/page-bg-people.png
catalog: true
tags:
    - Android
---

* 项目第一次打开，从MainActivity跳转到SplashActivity，动画结束之后重新初始化了一个MainActivity
* 一次EventBus事件重复注册Crash

#### Android 事件框架 EventBus

EvnetBus 是一个 Android 事件订阅/发布的框架：

![](img/post-img-eventbus.png)

是Android组件间的通信方案，有以下优势：

* 减少通信的冗余代码


* jar包大小50k
* 速度快
* 支持多种线程模式
* 开源（[EventBusGithub](https://github.com/greenrobot/EventBus)）

##### EventBus线程模式

EventBus总共有四种线程模式：

* ThreadMode.MAIN：表示无论哪个线程发布出来的，该订阅方法onEvent都会在UI线程中执行
* ThreadMode.POSTING：事件在哪个线程发出来，事件的订阅函数onEvent就会在这个线程中运行
* ThreadMode.BACKGROUND：事件如果在UI线程中发布出来，订阅函数就会在子线程中运行，如果本来就是在子线程中，则订阅函数就在那个线程中执行
* ThreadMode.AYSNC：无论如何都创建新的子线程来执行订阅函数

##### 注意事项

* 一般是在onCreate和onStart里注册，尽量不要在onResume里面注册，可能出现多次注册的Exception导致crash：

  ```
  ExentBusException: Subscriber class already registered to event class

  // 如果有多次执行的可能，则需要添加判断
  if (!EventBus.getDefault().isRegistered(this)) {
    	EventBus.getDefault().register(this);
  }
  ```

  ​

##### EventBus源码分析



#### Android 控件注入框架 Butter Knife  

